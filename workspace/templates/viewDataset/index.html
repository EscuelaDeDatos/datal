{% extends 'base_workspace.html' %}
{% load i18n extra_tags components dataset_tags compress staticfiles sass_tags %}

{% block meta %}
{% compress css %}
<link href="{% sass_src 'workspace/styles/detailCommon.scss' %}" type="text/css" rel="stylesheet" media="screen"/>
<link href="{% sass_src 'workspace/styles/viewDataset.scss' %}" type="text/css" rel="stylesheet" media="screen"/>
{% endcompress %}

<script type="text/javascript" src="/js_core/models.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/deleteItemView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/unpublishView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/affectedResourcesModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/affectedResourcesView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/affectedResourcesCollection.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/affectedResourcesCollectionDeleteView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/affectedResourcesCollectionUnpublishView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/datasetModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_workspace/viewDataset/datasetView.js?id={{settings.VERSION_JS_CSS}}"></script>

<meta name="main-option" content="id_datasets_option"/>
{% endblock %}

{% block header_navigation %}
<!-- Back Link -->
<a href="{% url 'manageDatasets.index' %}" id="id_backLink" class="button alpha back FL" title="{% trans 'APP-BACK-TEXT' %}">{% trans 'APP-BACK-TEXT' %}</a>
{% endblock %}

{% block sectionTitle %}
<div class="context-menu clearfix"></div>
{% endblock %}

{% block content %}
  <div class="detail hash-tabs" id="id_viewDataset">
    <article class="tab-container">

      <div class="ao-tabs col-xs-12">
        <div class="tabs-in relative">
          <ul class="tabsList clearfix">
            <nav class="tab-nav" role="tablist">
              <li class="tab">
                  <div class="clearfix">
                      <a href="#description" id="0" role="tab" aria-selected="true" aria-expanded="true" aria-controls="#description" tab-index="0">{% trans 'APP-DESCRIPTION-TEXT' %}</a>
                  </div>
              </li>
              {% if dataset.datastreams or dataset.visualizations %}
              <li class="tab">
                  <div class="clearfix">
                      <a href="#related-resources" id="1" role="tab" aria-selected="false" aria-expanded="false" aria-controls="#related-resources" tab-index="-1">{% trans 'APP-RELATED-RESOURCES-TEXT' %}</a>
                  </div>
              </li>
              {% endif %}
            </nav>
          </ul>
        </div>
      </div>

      <div class="resource-detail box">
        <div class="tab-pane-container">
        
          {% include "viewDataset/description.html" %}

          {% if dataset.datastreams or dataset.visualizations %}
            {% include "viewDataset/related_resources.html" %}
          {% endif %}

        </div>
      </div>

    </article>
  </div>

  {% include "viewDataset/templates.html" %}

{% endblock %}

{% block bottom_js %}
<script type="text/javascript" src="/js_core/plugins/jquery.hash-tabs.min.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript">
$(document).ready(function(){
  var Dataset = new DatasetModel({
    id: {{ dataset.last_revision_id }},
    dataset_id: {{ dataset.dataset_id }},
    status: {{ dataset.status }},
    status_str: "{{ dataset.status|status_str|capfirst }}",
    title: "{{ dataset.title|capfirst }}",
    createDataViewUrl: "{% url 'manageDataviews.create' %}?dataset_revision_id={{ dataset.dataset_revision_id }}",
    changeStatusUrl: "{% url 'manageDatasets.change_status' dataset.dataset_revision_id %}",
    lastPublishRevisionId: "{{ dataset.last_published_revision_id }}",
    editUrl: "{% url 'manageDatasets.edit' %}/{{dataset.dataset_revision_id}}/",
    lastPublishDate: "{{dataset.last_published_date|date:'F d, Y, h:i A'|capfirst}}",
    publicUrl: "{{ dataset.public_url }}",
    createdAt: "{{ dataset.created_at|date:'F d, Y, h:i A'|capfirst }}",
    modifiedAt: "{{ dataset.modified_at|date:'F d, Y, h:i A'|capfirst }}"
  });
  var DatasetView = new datasetView({model: Dataset});
});
</script>
{% endblock %}

{% block popupsOverlay %}
  {% include "viewDataset/overlays.html" %}
{% endblock %}