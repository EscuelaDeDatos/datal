{% extends 'base_workspace.html' %}
{% load i18n extra_tags core_components components %}

{% block meta %}
<link href="/media_core/styles/plugins/jquery-file-upload/jquery.fileupload-ui.css?id={{settings.VERSION_JS_CSS}}" type="text/css" rel="stylesheet" media="screen">
<link type="text/css" href="/media_core/styles/plugins/jquery-file-upload/jquery.fileupload.css?id={{settings.VERSION_JS_CSS}}" type="text/css" rel="stylesheet" media="screen">

<link href="/media_workspace/styles/createCommon.css?id={{settings.VERSION_JS_CSS}}" type="text/css" rel="stylesheet" media="screen"/>
<link href="/media_workspace/styles/createDataset.css?id={{settings.VERSION_JS_CSS}}" type="text/css" rel="stylesheet" media="screen"/>

<script type="text/javascript" src="/js_core/plugins/jquery-file-upload/js/jquery.fileupload.js?id={{settings.VERSION_JS_CSS}}"></script>
<script type="text/javascript" src="/js_core/plugins/nicEdit/nicEdit-2014.js?id={{settings.VERSION_JS_CSS}}"></script>

<script language="javascript" src="/js_workspace/processManager/stepModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/stepView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/dataset/collectFileModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/dataset/collectFileView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/dataset/finishModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/dataset/finishFileModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/dataset/finishView.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/processManagerModel.js?id={{settings.VERSION_JS_CSS}}"></script>
<script language="javascript" src="/js_workspace/processManager/processManagerView.js?id={{settings.VERSION_JS_CSS}}"></script>

<meta name="main-option" content="id_datasets_option"/>
{% endblock %}

{% block sectionTitle %}
<h1 class="FL"><a href="{% url 'manageDatasets.list' %}" title="{% trans 'APP-DATASETS-TEXT' %}">{% trans "APP-DATASETS-TEXT" %}</a></h1>
<h2 class="FL">{% trans 'APP-ADDNEW-TEXT' %}</h2>
<ul class="buttons-bar FR" data-step="1">
	{% include "createDataset/navigation.html" %}
</ul>
{% endblock %}

{% block content %}

	<form action="" class="create" id="id_createDataset">
		{% include "processManager/dataset/steps/collectFile.html" %}
		{% include "processManager/dataset/steps/finish.html" %}
	</form>

{% endblock %}

{% block bottom_js %}

<script type="text/javascript">
$(document).ready(function(){

	var collectFileModel = new CollectFileModel({
		name: 'collect',
	});
	var collectFileView = new CollectFileView({model: collectFileModel});

	var finishModel = new FinishFileModel({
		name: 'finish',
		saveUrl: "{% url 'manageDatasets.create_type' 'file' %}",
    sourceUrl: '/source_manager/action_search',
    tagUrl: '/tag_manager/action_search',
	});
	var finishView = new FinishView({model: finishModel});

	var processManagerModel = new ProcessManagerModel({
		startUrl: "{% url 'manageDatasets.create' %}",
		finishUrl: "{% url 'manageDatasets.list' %}"
	});
	var processManagerView = new ProcessManagerView({model: processManagerModel});

	processManagerView.register( collectFileView );
	processManagerView.register( finishView );

	processManagerView.start();

});
</script>

{% endblock %}